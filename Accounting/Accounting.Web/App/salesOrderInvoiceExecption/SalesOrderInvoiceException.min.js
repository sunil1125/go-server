define(["require","exports","plugins/router","durandal/app","durandal/system","../templates/reportViewerControlV2","services/models/common/Enums"],function(n,t,i,r,u,f,e){var l=i,h=r,c=u,o=f,s=e;return function(){function n(){this.reportContainer=null,this.header=null,this.grid=null,this.reportAction=null,this.reportData=null,this.modeType=ko.observable();var n=this,t=new Utils.Common;return n.header=new o.ReportHeaderOption,n.header.reportHeader="Invoice Exception Board",n.header.preparedOn=" ",n.header.createdBy=" ",n.header.reportName="Sales Order Invoice Exception",n.header.gridTitleHeader=" ",n.searchText=ko.observable(""),n.reportAction=new o.ReportAction,n.grid=n.setGridOptions(n),n.setReportCriteria=function(t){n.gridOptions=t.gridOptions,n.reportAction!=null&&(n.modeType()!=t.filter1selectedItemId||n.reportAction.view!=t.view||t.dateFrom!=n.reportAction.dateFrom||t.dateTo!=n.reportAction.dateTo),n.reportAction=t,n.getReportData(t)},n.getReportData=function(){var i=$.Deferred(),r=i.promise(),t=0;return t=Number(n.gridOptions.pagingOptions.currentPage()),t>0&&(n.reportContainer.listProgress(!0),n.setPagingData(null,5,n.gridOptions.pagingOptions.pageSize()),n.reportContainer.listProgress(!1)),r},n.header.actionButtons1={buttonName:ko.observable("Force Invoice"),enableOnSingleSelection:!0,enableOnMultiSelection:!0,hideWhenUnselected:!0,resetselectionOnAction:!0,isslideButton:!0},n.reportContainer=new o.ReportViewerControlV2(n.header,n.grid),n.reportContainer.showOptionalHeaderRow(!0),n.reportContainer.ForceChange(),n.reportContainer.onSearchTextChange=function(t,i){(i.length>=3||i.length==0)&&(n.searchText(i),n.gridOptions.pagingOptions.currentPage(1))},n.reportContainer.getDateFormat=function(n){var i=this;return t.formatDate(new Date(n.BillDate),"mm/dd/yyyy")},n.reportContainer.getTextfromId=function(n){var i=this;return t.getEnumValueById(s.Enums.VendorBillStatus,n.BillStatus.toString())},n.reportContainer.getMasClearanceStatus=function(n){var i=this;return t.getEnumValueById(s.Enums.MasClearanceStatus,n.MasClearanceStatusId.toString())},n.reportContainer.getModeType=function(n){var i=this;return t.getEnumValueById(s.Enums.CarrierType,n.ShipmentTypeId.toString())},n}return n.prototype.load=function(n){if(n){var t=this;c.isObject(t.gridOptions)&&(t.gridOptions.pagingOptions.pageSize(n.pageSize),t.gridOptions.pagingOptions.currentPage(n.currentPage),t.getReportData(t.reportAction))}},n.prototype.setGridOptions=function(n){var t=new o.ReportGridOption;return t.UIGridID=ko.observable("SalesOrderInvoiceExceptionGrid"),t.data=n.reportData,t.columnDefinition=n.setGridColumnDefinitions(),t.enableSelectiveDisplay=!0,t.useExternalSorting=!1,t.showGridSearchFilter=!0,t.sortedColumn={columnName:"CreatedDate",order:"DESC"},t.pageSizes=[10,25,50,100],t.pageSize=10,t.totalServerItems=0,t.currentPage=1,t.jqueryUIDraggable=!0,t.canSelectRows=!0,t.selectWithCheckboxOnly=!0,t.displaySelectionCheckbox=!0,t.multiSelect=!0,t.enablePaging=!1,t.viewPortOptions=!1,t.enableSaveGridSettings=!1,t.useClientSideFilterAndSort=!0,t.showColumnMenu=!0,t},n.prototype.setGridColumnDefinitions=function(){var n=this;return[{field:"BOLNumber",displayName:"BOL#",width:90},{field:"PRONumber",displayName:"PRO#",width:110},{field:"CarrierName",displayName:"Carrier",width:130},{field:"CustomerName",displayName:"Customer",width:150},{field:"SalesAgent",displayName:"Sales Agent",width:100},{field:"BookedDate",displayName:"Booked Date",width:150},{field:"PickupDate",displayName:"Pickup Date",width:150},{field:"FinalizeDate",displayName:"Finalize Date",width:150},{field:"AdjustmentDate",displayName:"Adjustment Date",width:150},{field:"CRRReviewDate",displayName:"CRR Review Date",width:150},{field:"CarrierType",displayName:"Mode",width:180},{field:"Cost",displayName:"Cost",width:180},{field:"Revenue",displayName:"Revenue",width:180},{field:"VBAmount",displayName:"VB Amount",width:180},{field:"SOStatus",displayName:"SO Status",width:180},{field:"InvoiceStatus",displayName:"Invoice Status",width:180},{field:"VBStatus",displayName:"VB Status",width:180},{field:"Exception Reason",displayName:"Exception Reason",width:180},{field:"ScheduledAge",displayName:"Scheduled Age",width:180}]},n.prototype.initializeVendorBillExceptions=function(n){var t=this;n?(t.reportContainer.OptionalHeaderRowLocation("TOP"),t.setPagingData(n,t.gridOptions,t.reportAction),$("#kgSpanFooterSelectedItems").text("0"),t.reportContainer.listProgress(!1),$(".noLeftBorder").parent().css("border-left","0px"),$(".noRightBorder").parent().css("border-right","0px")):t.reportContainer.listProgress(!1)},n.prototype.setPagingData=function(n,t){var i=this;i.gridOptions.data(n),i.gridOptions.data.valueHasMutated(),i.gridOptions.pagingOptions.totalServerItems(t)},n.prototype.attached=function(){h.trigger("viewAttached")},n.prototype.activate=function(){return!0},n.prototype.beforeBind=function(){var n=this;h.trigger("loadMyData",function(t){t&&n.load(t)})},n}()})